var o=Object.defineProperty;var m=(h,r,e)=>r in h?o(h,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[r]=e;var a=(h,r,e)=>(m(h,typeof r!="symbol"?r+"":r,e),e);const c=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(t){if(t.ep)return;t.ep=!0;const i=e(t);fetch(t.href,i)}};c();class d extends HTMLElement{constructor(){super();a(this,"leftNumber");a(this,"operator");a(this,"rightNumber");a(this,"availableThemes");a(this,"lightThemePreferredMQL");a(this,"screen");a(this,"bar");this.leftNumber="0",this.operator="",this.rightNumber="",this.availableThemes=["theme-1","theme-2","theme-3"],this.lightThemePreferredMQL=window.matchMedia("(prefers-color-scheme: light)");const e=localStorage.getItem("theme")||"";this.availableThemes.includes(e)?document.documentElement.dataset.theme=e:this.lightThemePreferredMQL.matches?document.documentElement.dataset.theme="theme-2":document.documentElement.dataset.theme="theme-1"}reduceExpression(){var e;if(this.operator!==""&&this.rightNumber!=="")switch(this.operator){case"+":this.leftNumber=String(Number(this.leftNumber)+Number(this.rightNumber));break;case"-":this.leftNumber=String(Number(this.leftNumber)-Number(this.rightNumber));break;case"x":this.leftNumber=String(Number(this.leftNumber)*Number(this.rightNumber));break;case"/":this.leftNumber=String(Number(this.leftNumber)/Number(this.rightNumber));break;default:throw new Error("Operator is not valid")}else throw new Error("Something went wrong");this.operator="",this.rightNumber="",(e=this.screen)==null||e.updateResult(this.leftNumber,this.operator,this.rightNumber)}handleNumber(e){var s;this.operator!==""?e==="0"?this.rightNumber!==""&&(this.rightNumber+=e):this.rightNumber+=e:e==="0"?this.leftNumber!=="0"&&(this.leftNumber+=e):this.leftNumber==="0"?this.leftNumber=e:this.leftNumber+=e,(s=this.screen)==null||s.updateResult(this.leftNumber,this.operator,this.rightNumber)}handleOperator(e){var s;this.operator!==""?this.rightNumber!==""&&(this.rightNumber.endsWith(".")&&(this.rightNumber=this.rightNumber.slice(0,this.rightNumber.length-1)),this.reduceExpression()):this.leftNumber.endsWith(".")&&(this.leftNumber=this.leftNumber.slice(0,this.leftNumber.length-1)),this.operator=e.replace("*","x"),(s=this.screen)==null||s.updateResult(this.leftNumber,this.operator,this.rightNumber)}handleFloat(){var e;this.operator!==""?this.rightNumber!==""&&(this.rightNumber.includes(".")||(this.rightNumber+=".")):this.leftNumber.includes(".")||(this.leftNumber+="."),(e=this.screen)==null||e.updateResult(this.leftNumber,this.operator,this.rightNumber)}handleResult(){var e,s;this.operator!==""?(this.rightNumber.endsWith(".")&&(this.rightNumber=this.rightNumber.slice(0,this.rightNumber.length-1)),this.rightNumber!==""?this.reduceExpression():(this.operator="",(e=this.screen)==null||e.updateResult(this.leftNumber,this.operator,this.rightNumber))):this.leftNumber.endsWith(".")&&(this.leftNumber=this.leftNumber.slice(0,this.leftNumber.length-1),(s=this.screen)==null||s.updateResult(this.leftNumber,this.operator,this.rightNumber))}handleDelete(){var e;this.operator!==""?this.rightNumber!==""?this.rightNumber=this.rightNumber.slice(0,this.rightNumber.length-1):this.operator="":this.leftNumber.length>1?this.leftNumber=this.leftNumber.slice(0,this.leftNumber.length-1):this.leftNumber="0",(e=this.screen)==null||e.updateResult(this.leftNumber,this.operator,this.rightNumber)}handleReset(){var e;this.leftNumber="0",this.operator="",this.rightNumber="",(e=this.screen)==null||e.updateResult(this.leftNumber,this.operator,this.rightNumber)}connectedCallback(){this.screen=document.createElement("app-screen"),this.bar=this.createBar();const e=this.createKeypad();this.listenKeyboard(),this.append(this.bar,this.screen,e),this.lightThemePreferredMQL.addEventListener("change",()=>{var t;const s=localStorage.getItem("theme")||"";this.availableThemes.includes(s)||(document.documentElement.dataset.theme=this.lightThemePreferredMQL.matches?"theme-2":"theme-1",(t=this.bar)==null||t.setActiveThemeSwitchInput(document.documentElement.dataset.theme))})}createBar(){const e=document.createElement("app-bar");return e==null||e.addEventListener("app-theme-switch",s=>{const t=s.detail.newTheme;localStorage.setItem("theme",t),document.documentElement.dataset.theme=t}),e}createKeypad(){const e=document.createElement("app-keypad");return e.addEventListener("app-key-pressed",s=>{const t=s.detail.key;switch(t.type){case"number":this.handleNumber(t.label);break;case"operator":this.handleOperator(t.label);break;case"float":this.handleFloat();break;case"result":this.handleResult();break;case"reset":this.handleReset();break;case"delete":this.handleDelete();break;default:throw new Error("The key type is not valid")}}),e}listenKeyboard(){document.addEventListener("keydown",e=>{const s=e.key,t=/^\d$/,i=/^[*x\-+/]$/,l=/^Enter$|^=$/,n=/^Delete$|^Backspace$/,u=/^[.,]$/;t.test(s)?this.handleNumber(s):i.test(s)?this.handleOperator(s):u.test(s)?this.handleFloat():n.test(s)?this.handleDelete():l.test(s)&&this.handleResult()})}}class p extends HTMLElement{constructor(){super()}connectedCallback(){this.classList.add("bar");const r=document.createElement("h1"),e=this.createThemeSwitch();r.classList.add("bar__title"),r.textContent="calc",this.append(r,e)}setActiveThemeSwitchInput(r){const e=document.querySelector(`.theme-switch__input[value=${r}]`);e.checked=!0}createThemeSwitch(){const e=document.getElementById("template-theme-switch").content.cloneNode(!0),s=e.querySelector(".theme-switch"),t=e.querySelectorAll(".theme-switch__input"),i=document.documentElement.dataset.theme;return t.forEach(l=>{l.value===i&&(l.checked=!0),l.addEventListener("change",n=>{const u=n.target.value;this.dispatchEvent(new CustomEvent("app-theme-switch",{detail:{newTheme:u}}))})}),s}}class b extends HTMLElement{constructor(){super();a(this,"result")}updateResult(e,s,t){if(this.result){const i=`${e}${s!==""?` ${s}`:""}${t!==""?` ${t}`:""}`;this.result.textContent=i.replace(/[.]/g,",")}}connectedCallback(){this.classList.add("screen");const e=document.createElement("div");this.result=document.createElement("p"),e.classList.add("screen__frame"),this.result.classList.add("screen__result"),this.result.textContent="0",e.appendChild(this.result),this.appendChild(e)}}class f extends HTMLElement{constructor(){super();a(this,"keys");this.keys=[{label:"7",shape:"square",type:"number"},{label:"8",shape:"square",type:"number"},{label:"9",shape:"square",type:"number"},{label:"del",shape:"square",type:"delete"},{label:"4",shape:"square",type:"number"},{label:"5",shape:"square",type:"number"},{label:"6",shape:"square",type:"number"},{label:"+",shape:"square",type:"operator"},{label:"1",shape:"square",type:"number"},{label:"2",shape:"square",type:"number"},{label:"3",shape:"square",type:"number"},{label:"-",shape:"square",type:"operator"},{label:".",shape:"square",type:"float"},{label:"0",shape:"square",type:"number"},{label:"/",shape:"square",type:"operator"},{label:"x",shape:"square",type:"operator"},{label:"reset",shape:"rectangle",type:"reset"},{label:"=",shape:"rectangle",type:"result"}]}connectedCallback(){this.classList.add("keypad"),this.keys.forEach(e=>{const s=document.createElement("button"),t=document.createElement("span");s.classList.add("key",`key--${e.shape}`,`key--${e.type}`),t.classList.add("key__label"),t.textContent=e.label,s.appendChild(t),s.addEventListener("click",()=>{this.dispatchEvent(new CustomEvent("app-key-pressed",{detail:{key:e}}))}),this.appendChild(s)})}}customElements.define("app-bar",p);customElements.define("app-screen",b);customElements.define("app-keypad",f);customElements.define("app-root",d);
